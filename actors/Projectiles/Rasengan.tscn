[gd_scene load_steps=103 format=2]

[ext_resource path="res://Objects/lightning-ball-png-8.png" type="Texture" id=1]
[ext_resource path="res://Particles/particles/tile000.png" type="Texture" id=2]
[ext_resource path="res://Particles/particles/tile001.png" type="Texture" id=3]
[ext_resource path="res://Particles/particles/tile002.png" type="Texture" id=4]
[ext_resource path="res://Particles/particles/tile003.png" type="Texture" id=5]
[ext_resource path="res://Particles/particles/tile004.png" type="Texture" id=6]
[ext_resource path="res://Particles/particles/tile005.png" type="Texture" id=7]
[ext_resource path="res://Particles/particles/tile006.png" type="Texture" id=8]
[ext_resource path="res://Particles/particles/tile007.png" type="Texture" id=9]
[ext_resource path="res://Particles/particles/tile008.png" type="Texture" id=10]
[ext_resource path="res://Particles/particles/tile009.png" type="Texture" id=11]
[ext_resource path="res://Particles/particles/tile010.png" type="Texture" id=12]
[ext_resource path="res://Particles/particles/tile011.png" type="Texture" id=13]
[ext_resource path="res://Particles/particles/tile012.png" type="Texture" id=14]
[ext_resource path="res://Particles/particles/tile013.png" type="Texture" id=15]
[ext_resource path="res://Particles/particles/tile014.png" type="Texture" id=16]
[ext_resource path="res://Particles/particles/tile015.png" type="Texture" id=17]
[ext_resource path="res://Particles/particles/tile016.png" type="Texture" id=18]
[ext_resource path="res://Particles/particles/tile017.png" type="Texture" id=19]
[ext_resource path="res://Particles/particles/tile018.png" type="Texture" id=20]
[ext_resource path="res://Particles/particles/tile019.png" type="Texture" id=21]
[ext_resource path="res://Particles/particles/tile020.png" type="Texture" id=22]
[ext_resource path="res://Particles/particles/tile021.png" type="Texture" id=23]
[ext_resource path="res://Particles/particles/tile022.png" type="Texture" id=24]
[ext_resource path="res://Particles/particles/tile023.png" type="Texture" id=25]
[ext_resource path="res://Particles/particles/tile024.png" type="Texture" id=26]
[ext_resource path="res://Particles/particles/tile025.png" type="Texture" id=27]
[ext_resource path="res://Particles/particles/tile026.png" type="Texture" id=28]
[ext_resource path="res://Particles/particles/tile027.png" type="Texture" id=29]
[ext_resource path="res://Particles/particles/tile028.png" type="Texture" id=30]
[ext_resource path="res://Particles/particles/tile029.png" type="Texture" id=31]
[ext_resource path="res://Particles/particles/tile030.png" type="Texture" id=32]
[ext_resource path="res://Particles/particles/tile031.png" type="Texture" id=33]
[ext_resource path="res://Particles/particles/tile032.png" type="Texture" id=34]
[ext_resource path="res://Particles/particles/tile033.png" type="Texture" id=35]
[ext_resource path="res://Particles/particles/tile034.png" type="Texture" id=36]
[ext_resource path="res://Particles/particles/tile035.png" type="Texture" id=37]
[ext_resource path="res://Particles/particles/tile036.png" type="Texture" id=38]
[ext_resource path="res://Particles/particles/tile037.png" type="Texture" id=39]
[ext_resource path="res://Particles/particles/tile038.png" type="Texture" id=40]
[ext_resource path="res://Particles/particles/tile039.png" type="Texture" id=41]
[ext_resource path="res://Particles/particles/tile040.png" type="Texture" id=42]
[ext_resource path="res://Particles/particles/tile041.png" type="Texture" id=43]
[ext_resource path="res://Particles/particles/tile042.png" type="Texture" id=44]
[ext_resource path="res://Particles/particles/tile043.png" type="Texture" id=45]
[ext_resource path="res://Particles/particles/tile044.png" type="Texture" id=46]
[ext_resource path="res://Particles/particles/tile045.png" type="Texture" id=47]
[ext_resource path="res://Particles/particles/tile046.png" type="Texture" id=48]
[ext_resource path="res://Particles/particles/tile047.png" type="Texture" id=49]
[ext_resource path="res://Particles/particles/tile048.png" type="Texture" id=50]
[ext_resource path="res://Particles/particles/tile049.png" type="Texture" id=51]
[ext_resource path="res://Particles/particles/tile050.png" type="Texture" id=52]
[ext_resource path="res://Particles/particles/tile051.png" type="Texture" id=53]
[ext_resource path="res://Particles/particles/tile052.png" type="Texture" id=54]
[ext_resource path="res://Particles/particles/tile053.png" type="Texture" id=55]
[ext_resource path="res://Particles/particles/tile054.png" type="Texture" id=56]
[ext_resource path="res://Particles/particles/tile055.png" type="Texture" id=57]
[ext_resource path="res://Particles/particles/tile056.png" type="Texture" id=58]
[ext_resource path="res://Particles/particles/tile057.png" type="Texture" id=59]
[ext_resource path="res://Particles/particles/tile058.png" type="Texture" id=60]
[ext_resource path="res://Particles/particles/tile059.png" type="Texture" id=61]
[ext_resource path="res://Particles/particles/tile060.png" type="Texture" id=62]
[ext_resource path="res://Particles/particles/tile061.png" type="Texture" id=63]
[ext_resource path="res://Particles/particles/tile062.png" type="Texture" id=64]
[ext_resource path="res://Particles/particles/tile063.png" type="Texture" id=65]
[ext_resource path="res://Particles/particles/tile064.png" type="Texture" id=66]
[ext_resource path="res://Particles/particles/tile065.png" type="Texture" id=67]
[ext_resource path="res://Particles/particles/tile066.png" type="Texture" id=68]
[ext_resource path="res://Particles/particles/tile067.png" type="Texture" id=69]
[ext_resource path="res://Particles/particles/tile068.png" type="Texture" id=70]
[ext_resource path="res://Particles/particles/tile069.png" type="Texture" id=71]
[ext_resource path="res://Particles/particles/tile070.png" type="Texture" id=72]
[ext_resource path="res://Particles/particles/tile071.png" type="Texture" id=73]
[ext_resource path="res://Particles/particles/tile072.png" type="Texture" id=74]
[ext_resource path="res://Particles/particles/tile073.png" type="Texture" id=75]
[ext_resource path="res://Particles/particles/tile074.png" type="Texture" id=76]
[ext_resource path="res://Particles/particles/tile075.png" type="Texture" id=77]
[ext_resource path="res://Particles/particles/tile076.png" type="Texture" id=78]
[ext_resource path="res://Particles/particles/tile077.png" type="Texture" id=79]
[ext_resource path="res://Particles/particles/tile078.png" type="Texture" id=80]
[ext_resource path="res://Particles/particles/tile079.png" type="Texture" id=81]
[ext_resource path="res://Particles/particles/tile080.png" type="Texture" id=82]
[ext_resource path="res://Particles/particles/tile081.png" type="Texture" id=83]
[ext_resource path="res://Particles/particles/tile082.png" type="Texture" id=84]
[ext_resource path="res://Particles/particles/tile083.png" type="Texture" id=85]
[ext_resource path="res://Particles/particles/tile084.png" type="Texture" id=86]
[ext_resource path="res://Particles/particles/tile085.png" type="Texture" id=87]
[ext_resource path="res://Particles/particles/tile086.png" type="Texture" id=88]
[ext_resource path="res://Particles/particles/tile087.png" type="Texture" id=89]
[ext_resource path="res://Particles/particles/tile088.png" type="Texture" id=90]
[ext_resource path="res://Particles/particles/tile089.png" type="Texture" id=91]
[ext_resource path="res://Particles/particles/tile090.png" type="Texture" id=92]
[ext_resource path="res://Particles/particlePack_1.1/PNG (Transparent)/twirl_02.png" type="Texture" id=93]


[sub_resource type="GDScript" id=1]
script/source = "extends KinematicBody2D

var speed = 400
const dyingTimerMax = 400.0

var velocity = Vector2()
var launchTimer = 1
var launchTimerTemp = 1
var direction = 1
var dyingTimer = 0.0

onready var anim = $\"AnimatedSprite\"
#onready var light = $\"Light2D\"
onready var particlesOrbit = $\"ParticlesOrbit\"
onready var smoke = $\"smoke\"


func _ready():
	pass
	
func _physics_process(delta: float) -> void:
	if launchTimerTemp <= 0:
		self.velocity.x = delta * speed * self.direction / 0.016667

	else:
		self.launchTimerTemp -= 1
		var opacity = float(launchTimer - launchTimerTemp)/ launchTimer
		smoke.get_process_material().scale = 0.2 - opacity*0.08
		$\"green\".modulate.a = opacity - 0.5
		$\"green\".scale = Vector2(2 - opacity, 2 - opacity)
		self.anim.modulate.a = opacity
		self.anim.scale = Vector2(0.03 + opacity*0.02, 0.03 + opacity*0.02)
		self.particlesOrbit.get_process_material().set(\"emission_sphere_radius\", 40 + launchTimerTemp*0.03)
		$\"CollisionShape2D\".scale = Vector2(1 + opacity*0.02, 1 + opacity*0.02)
		$bullet/damage.scale = Vector2(1 + opacity, 1 + opacity)

		
		#light.scale = Vector2(0.6 + opacity * 0.02, 0.6 + opacity * 0.02)
		
	if is_on_wall():
		if dyingTimer >= dyingTimerMax:
			self.queue_free()
		else:
			self.dyingTimer += 1
			self.velocity.x = 0
			self.anim.modulate.a = (dyingTimerMax - dyingTimer)/ dyingTimerMax
			
	self.move_and_slide(velocity)
	
func setDirection(direction:int):
	self.direction = direction
	
func setLaunchTimer(time:int):
	self.launchTimer = time
	self.launchTimerTemp = time
	
func _on_hitbox_area_entered(area: Area2D) -> void:
	if area.get_name() == \"hurtbox\":
		if dyingTimer >= dyingTimerMax:
			self.queue_free()
		else:
			self.dyingTimer += 1
			self.velocity.x = 0
			self.anim.modulate.a = (dyingTimerMax - dyingTimer)/ dyingTimerMax
			
			
		"

[sub_resource type="SpriteFrames" id=2]
animations = [ {
"frames": [ ExtResource( 1 ) ],
"loop": true,
"name": "default",
"speed": 5.0
} ]

[sub_resource type="CircleShape2D" id=3]

[sub_resource type="ParticlesMaterial" id=4]
emission_shape = 1
emission_sphere_radius = 36.0
flag_disable_z = true
gravity = Vector3( 0, 0, 0 )
angular_velocity = 4.57538e-41
orbit_velocity = 0.3
orbit_velocity_random = 1.0
scale = 0.5
color = Color( 0.0705882, 0.713726, 0.862745, 1 )

[sub_resource type="SpriteFrames" id=5]
animations = [ {
"frames": [ ExtResource( 2 ), ExtResource( 3 ), ExtResource( 4 ), ExtResource( 5 ), ExtResource( 6 ), ExtResource( 7 ), ExtResource( 8 ), ExtResource( 9 ), ExtResource( 10 ), ExtResource( 11 ), ExtResource( 12 ), ExtResource( 13 ), ExtResource( 14 ), ExtResource( 15 ), ExtResource( 16 ), ExtResource( 17 ), ExtResource( 18 ), ExtResource( 19 ), ExtResource( 20 ), ExtResource( 21 ), ExtResource( 22 ), ExtResource( 23 ), ExtResource( 24 ), ExtResource( 25 ), ExtResource( 26 ), ExtResource( 27 ), ExtResource( 28 ), ExtResource( 29 ), ExtResource( 30 ), ExtResource( 31 ), ExtResource( 32 ), ExtResource( 33 ), ExtResource( 34 ), ExtResource( 35 ), ExtResource( 36 ), ExtResource( 37 ), ExtResource( 38 ), ExtResource( 39 ), ExtResource( 40 ), ExtResource( 41 ), ExtResource( 42 ), ExtResource( 43 ), ExtResource( 44 ), ExtResource( 45 ), ExtResource( 46 ), ExtResource( 47 ), ExtResource( 48 ), ExtResource( 49 ), ExtResource( 50 ), ExtResource( 51 ), ExtResource( 52 ), ExtResource( 53 ), ExtResource( 54 ), ExtResource( 55 ), ExtResource( 56 ), ExtResource( 57 ), ExtResource( 58 ), ExtResource( 59 ), ExtResource( 60 ), ExtResource( 61 ), ExtResource( 62 ), ExtResource( 63 ), ExtResource( 64 ), ExtResource( 65 ), ExtResource( 66 ), ExtResource( 67 ), ExtResource( 68 ), ExtResource( 69 ), ExtResource( 70 ), ExtResource( 71 ), ExtResource( 72 ), ExtResource( 73 ), ExtResource( 74 ), ExtResource( 75 ), ExtResource( 76 ), ExtResource( 77 ), ExtResource( 78 ), ExtResource( 79 ), ExtResource( 80 ), ExtResource( 81 ), ExtResource( 82 ), ExtResource( 83 ), ExtResource( 84 ), ExtResource( 85 ), ExtResource( 86 ), ExtResource( 87 ), ExtResource( 88 ), ExtResource( 89 ), ExtResource( 90 ), ExtResource( 91 ), ExtResource( 92 ) ],
"loop": true,
"name": "default",
"speed": 5.0
} ]

[sub_resource type="CircleShape2D" id=6]

[sub_resource type="Gradient" id=7]
offsets = PoolRealArray( 0.692308, 0.892308, 1 )
colors = PoolColorArray( 0.60735, 0.821557, 0.977871, 1, 0.589146, 0.786778, 0.930996, 1, 0.494144, 0.795146, 0.95834, 1 )

[sub_resource type="GradientTexture" id=8]
gradient = SubResource( 7 )

[sub_resource type="ParticlesMaterial" id=9]
emission_shape = 1
emission_sphere_radius = 1.0
flag_disable_z = true
gravity = Vector3( 0, 0, 0 )
angular_velocity = 500.0
angular_velocity_random = 1.0
orbit_velocity = 0.0
orbit_velocity_random = 0.0
scale = 0.3
color_ramp = SubResource( 8 )

[node name="Rasengan" type="KinematicBody2D"]
script = SubResource( 1 )

[node name="AnimatedSprite" type="AnimatedSprite" parent="."]
scale = Vector2( 0.03, 0.03 )
frames = SubResource( 2 )
playing = true

[node name="CollisionShape2D" type="CollisionShape2D" parent="."]
position = Vector2( 0.451832, 0 )
shape = SubResource( 3 )

[node name="ParticlesOrbit" type="Particles2D" parent="."]
amount = 300
process_material = SubResource( 4 )

[node name="green" type="AnimatedSprite" parent="."]
modulate = Color( 0, 0.345098, 1, 1 )
show_behind_parent = true
position = Vector2( -0.778015, -2.33408 )
frames = SubResource( 5 )
frame = 42
speed_scale = 10.0
playing = true

[node name="bullet" type="Area2D" parent="." groups=[
"sword1",
]]
editor/display_folded = true

[node name="damage" type="CollisionShape2D" parent="bullet"]
position = Vector2( 0.194504, -0.778027 )
shape = SubResource( 6 )

[node name="smoke" type="Particles2D" parent="."]
self_modulate = Color( 1, 0.937255, 0.937255, 1 )
show_behind_parent = true
amount = 6
process_material = SubResource( 9 )
texture = ExtResource( 93 )
[connection signal="area_entered" from="bullet" to="." method="_on_hitbox_area_entered"]
